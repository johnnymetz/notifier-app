setup:
  addons:
    - plan: cloudamqp:lemur
    - plan: heroku-postgresql:hobby-dev
build:
  docker:
    web: api/Dockerfile
run:
  # https://devcenter.heroku.com/articles/process-model
  web:
    command:
      - ./manage.py collectstatic --noinput; ./manage.py migrate; gunicorn api.wsgi:application --bind=0.0.0.0:$PORT
    image: web
  worker:
    command:
      - celery worker -A api -l info
    image: web
  # beat:
  #   command:
  #     - celery beat -A api -l info --scheduler django_celery_beat.schedulers:DatabaseScheduler
  #   image: web
